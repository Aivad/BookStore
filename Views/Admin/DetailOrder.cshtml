@model BookStore.Models.Order
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Order Details";
}

<h2>Order #@Model.Id</h2>

<div class="row mb-3">
    <div class="col-md-6">
        <h5>Customer</h5>
        <p><strong>@Model.User?.UserName</strong><br />@Model.User?.Email</p>
    </div>
    <div class="col-md-6 text-end">
        <h5>Order Summary</h5>
        <p>
            Date: @Model.OrderDate.ToString("dd MMM yyyy HH:mm")<br />
            Total: <strong>Rp @Model.TotalAmount.ToString("N0", new System.Globalization.CultureInfo("id-ID"))</strong><br />
            Payment: <strong>@Model.PaymentMethod?.Name</strong>
        </p>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h5>Order Items</h5>
    </div>
    <div class="card-body">
        <table class="table">
            <thead>
                <tr>
                    <th>Book</th>
                    <th>Price</th>
                    <th>Qty</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.OrderItems)
                {
                    <tr>
                        <td>@item.Book?.Title</td>
                        <td>Rp @item.PriceAtPurchase.ToString("N0")</td>
                        <td>@item.Quantity</td>
                        <td>Rp @(item.PriceAtPurchase* item.Quantity)</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="d-flex justify-content-between">
    <a asp-action="IndexOrder" class="btn btn-secondary">← Back to Orders</a>

    <!-- Status Update Form -->
    <form asp-action="UpdateOrderStatus" method="post" class="d-inline">
        <input type="hidden" name="orderId" value="@Model.Id" />
        <select name="status" class="form-select d-inline" style="width: auto; display: inline-block;" onchange="this.form.submit()">
            <option value="Pending" selected="@(Model.Status == "Pending")">Pending</option>
            <option value="Confirmed" selected="@(Model.Status == "Confirmed")">Confirmed</option>
            <option value="Shipped" selected="@(Model.Status == "Shipped")">Shipped</option>
            <option value="Delivered" selected="@(Model.Status == "Delivered")">Delivered</option>
        </select>
    </form>
</div>